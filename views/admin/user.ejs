 
 <%- include('../layouts/adminHeader.ejs') %>

 

<!--start sidebar-->
<aside class="sidebar-wrapper" data-simplebar="true">
  <div class="sidebar-header">
    <div class="logo-icon">
      <img src="assets/images/logo-icon.png" class="logo-img" alt="">
    </div>
    <div class="logo-name flex-grow-1">
      <h5 class="mb-0">Dashboard</h5>
    </div>
    <div class="sidebar-close">
      <span class="material-icons-outlined">close</span>
    </div>
  </div>
  <div class="sidebar-nav">
      <!--navigation-->
      <ul class="metismenu" id="sidenav">
        <li>
          <a href="javascript:;" class="has-arrow">
            <div class="parent-icon"><i class="material-icons-outlined">home</i>
            </div>
            <div class="menu-title">Dashboard</div>
          </a>
          <ul>
            <li><a href="index.html"><i class="material-icons-outlined">arrow_right</i>Analysis</a>
            </li>
            <li><a href="index2.html"><i class="material-icons-outlined">arrow_right</i>eCommerce</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="javascript:;" class="has-arrow">
            <div class="parent-icon"><i class="material-icons-outlined">widgets</i>
            </div>
            <div class="menu-title">Users</div>
          </a>
          <ul>
            <li><a href="/admin/users"><i class="material-icons-outlined">arrow_right</i>Users List</a>
            </li>
            <!-- <li><a href="widgets-static.html"><i class="material-icons-outlined">arrow_right</i>User Details</a> -->
            </li>
          </ul>
        </li>
        <li>
          <a href="/admin/category" class="arrow_right" >
            <div class="parent-icon"><i class="material-icons-outlined">category</i>
            </div>
            <div class="menu-title">Category</div>
          </a>
  </div>
</aside>


  <!--start main wrapper-->
  <main class="main-wrapper">
    <div class="main-content">
      <!--breadcrumb-->
				<div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
					<div class="breadcrumb-title pe-3">LuxeWatches</div>
					<div class="ps-3">
						<nav aria-label="breadcrumb">
							<ol class="breadcrumb mb-0 p-0">
								<li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt"></i></a>
								</li>
								<li class="breadcrumb-item active" aria-current="page">Customers</li>
							</ol>
						</nav>
					</div>


				</div>
				 

        <div class="row g-3">
          <div class="col-auto">
            <div class="position-relative">
            
            </div>
          </div>
          <div class="col-auto flex-grow-1 overflow-auto">
            <div class="btn-group position-static">
              <div class="btn-group position-static">
              
              </div>


            </div>  
          </div>
          <div class="col-auto">
            <div class="d-flex align-items-center gap-2 justify-content-lg-end">
            </div>
          </div>
        </div><!--end row-->

        <div class="card mt-4">
          <div class="card-body">
            <div class="customer-table">
              <div class="table-responsive white-space-nowrap">
                 <table class="table align-middle">
                  <thead class="table-light">     
                    <tr>
                      <th>
                        <input class="form-check-input" type="checkbox">
                      </th>
                      <th>Customer Name</th>
                      <th>Email</th>
                      <th>Mobile</th>
                      <!-- <th>Is Verified</th> -->
                      <!-- <th>Status</th> -->
                      <th>Action</th>
                    </tr>
                   </thead>
                   <tbody>

                   <% for(let i=0;i<users.length;i++) { %>
                    <input type="hidden" value="<%= users[i]._id %>">
                     <tr>
                       <td>
                         <input class="form-check-input" type="checkbox">
                       </td>
                       <td>
                        <a class="d-flex align-items-center gap-3" href="javascript:;">
                          <div class="customer-pic">
                            <!-- <img src="assets/images/avatars/01.png" class="rounded-circle" width="40" height="40" alt=""> -->
                          </div>
                          <p class="mb-0 customer-name fw-bold"><%= users[i].name %></p>  
                        </a>
                       </td>
                       <td>
                          <a href="javascript:;" class="font-text1"><%= users[i].email %></a>
                       </td>
                       <td><%= users[i].phone %></td>
                       <!-- <td><%= users[i].is_verified ? 'Yes' : 'No' %></td> -->
                       <!-- <td id="status-<%= users[i]._id %>"><%= users[i].is_blocked ? 'Blocked' : 'Active' %></td> -->
                       <td>
                        <button onclick="blockUser('<%= users[i]._id %>',this)"  class="block-button btn btn-sm <%= users[i].is_blocked ? 'alert-success' : 'alert-danger' %> rounded font-sm" data-id="<%= users[i]._id %>">
                          <%= users[i].is_blocked ? 'Unblock' : 'Block' %>
                        </button>
                      </td>
                     </tr>
                     <% } %>
              
                   </tbody>
                 </table>
              </div>
            </div>
          </div>
        </div>
       

    </div>
  </main>
  <!--end main wrapper-->


    <!--start overlay-->
    <div class="overlay btn-toggle"></div>
    <!--end overlay-->

    <%- include('../layouts/adminFooter.ejs') %>

    <script>
     async function blockUser(userId,buttonElement){
        try {
         const response= await fetch(`/admin/users/block/${userId}`,{
            method:"PUT",
            headers:{
              'Content-Type': 'application/json'
            }
          })
          const result = await response.json();
            if(result.isBlocked === true){
              buttonElement.textContent = 'Unblock';
              buttonElement.classList.remove('alert-danger');
              buttonElement.classList.add('alert-success');
            }else{
              buttonElement.textContent = 'Block';
              buttonElement.classList.remove('alert-success');
              buttonElement.classList.add('alert-danger');
            }
        } catch (error) {
          consoler.error(error.message)
          
        }
      }
      const button = document.getElementById('blockUserButton');

    </script>